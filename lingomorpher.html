<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lingo Morpher</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body {
            font-family: 'Poppins', sans-serif;
        }
        #root {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background: linear-gradient(135deg, #C9BBDD 0%, #A992C7 100%);
        }
        @media (min-width: 640px) {
            #root {
                flex-direction: row;
            }
        }
        input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            background: #D9C3D3;
            outline: none;
            opacity: 0.8;
            -webkit-transition: .2s;
            transition: opacity .2s;
            border-radius: 4px;
        }

        input[type="range"]:hover {
            opacity: 1;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: #78609A;
            cursor: pointer;
            border-radius: 50%;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            border: 2px solid #ffffff;
        }

        input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: #78609A;
            cursor: pointer;
            border-radius: 50%;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            border: 2px solid #ffffff;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .fade-in-animation {
            animation: fadeIn 2s ease-in-out forwards;
        }
        .great-vibes-font {
            font-family: 'Great Vibes', cursive;
        }
        .cinzel-decorative {
            font-family: 'Cinzel Decorative', serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const LanguageTranslator = () => {
            const [sourceText, setSourceText] = React.useState('');
            const [translatedText, setTranslatedText] = React.useState('');
            const [sourceLang, setSourceLang] = React.useState('en');
            const [targetLang, setTargetLang] = React.useState('ta');
            const [isLoading, setIsLoading] = React.useState(false);
            const [error, setError] = React.useState('');
            const [history, setHistory] = React.useState(() => {
                const savedHistory = localStorage.getItem('lingoMorpherLanguageHistory');
                return savedHistory ? JSON.parse(savedHistory) : [];
            });

            React.useEffect(() => {
                localStorage.setItem('lingoMorpherLanguageHistory', JSON.stringify(history));
            }, [history]);

            const handleTranslate = async () => {
                setIsLoading(true);
                setError('');
                setTranslatedText('');

                if (!sourceText.trim()) {
                    setError('Please enter text to translate.');
                    setIsLoading(false);
                    return;
                }

                const langMap = {
                    'en': 'English',
                    'ta': 'Tamil',
                    'hi': 'Hindi'
                };
                const prompt = `Translate the following text from ${langMap[sourceLang]} to ${langMap[targetLang]}:\n\n${sourceText}`;
                let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];

                const payload = { contents: chatHistory };
                const apiKey = "AIzaSyA3uewnpVjG2dxwCgCNEyNBGeqk8cJP0ho";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                let retries = 0;
                const maxRetries = 5;
                const baseDelay = 1000;

                while (retries < maxRetries) {
                    try {
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }

                        const result = await response.json();

                        if (result.candidates && result.candidates.length > 0 &&
                            result.candidates[0].content && result.candidates[0].content.parts &&
                            result.candidates[0].content.parts.length > 0) {
                            const text = result.candidates[0].content.parts[0].text;
                            if (text && text.trim().length > 0) {
                                setTranslatedText(text);
                                setHistory(prevHistory => [{
                                    input: sourceText,
                                    output: text,
                                    sourceLang: langMap[sourceLang],
                                    targetLang: langMap[targetLang]
                                }, ...prevHistory].slice(0, 4));
                                break;
                            } else {
                                setError('Translation resulted in empty text. Please try a different input or language pair.');
                                break;
                            }
                        } else {
                            setError('Failed to get a valid translation from the model. Response structure unexpected.');
                            break;
                        }
                    } catch (e) {
                        retries++;
                        if (retries < maxRetries) {
                            const delay = baseDelay * Math.pow(2, retries - 1);
                            await new Promise(res => setTimeout(res, delay));
                        } else {
                            setError(`Error translating text after multiple retries: ${e.message}. Please try again later.`);
                        }
                    }
                }
                setIsLoading(false);
            };


            return (
                <div className="p-6 sm:p-8 rounded-xl shadow-lg w-full max-w-4xl border border-gray-200 bg-white">
                    <h2 className="text-3xl sm:text-4xl font-extrabold text-center text-gray-800 mb-6 font-poppins">
                        Language Translator
                    </h2>
                    <p className="text-center text-gray-600 mb-8 font-poppins">
                        Translate text between English, Tamil, and Hindi.
                    </p>

                    <div className="flex flex-col sm:flex-row justify-between items-center mb-6 space-y-4 sm:space-y-0 sm:space-x-4">
                        <div className="w-full sm:w-1/2">
                            <label htmlFor="sourceLang" className="block text-lg font-medium text-gray-700 mb-2 font-poppins">
                                Source Language:
                            </label>
                            <select
                                id="sourceLang"
                                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-200 ease-in-out bg-white font-poppins"
                                value={sourceLang}
                                onChange={(e) => setSourceLang(e.target.value)}
                            >
                                <option value="en">English</option>
                                <option value="ta">Tamil</option>
                                <option value="hi">Hindi</option>
                            </select>
                        </div>
                        <div className="w-full sm:w-1/2">
                            <label htmlFor="targetLang" className="block text-lg font-medium text-gray-700 mb-2 font-poppins">
                                Target Language:
                            </label>
                            <select
                                id="targetLang"
                                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-200 ease-in-out bg-white font-poppins"
                                value={targetLang}
                                onChange={(e) => setTargetLang(e.target.value)}
                            >
                                <option value="en">English</option>
                                <option value="ta">Tamil</option>
                                <option value="hi">Hindi</option>
                            </select>
                        </div>
                    </div>

                    <div className="mb-6">
                        <label htmlFor="sourceText" className="block text-lg font-medium text-gray-700 mb-2 font-poppins">
                            Text to Translate:
                        </label>
                        <textarea
                            id="sourceText"
                            className="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-200 ease-in-out resize-y min-h-[120px] font-poppins"
                            placeholder="Enter text to translate..."
                            value={sourceText}
                            onChange={(e) => setSourceText(e.target.value)}
                            rows="6"
                        ></textarea>
                    </div>

                    <div className="text-center mb-8">
                        <button
                            onClick={handleTranslate}
                            className="w-full sm:w-auto px-6 py-3 bg-green-600 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-300 ease-in-out transform hover:scale-105 font-poppins"
                            disabled={isLoading || !sourceText.trim()}
                        >
                            {isLoading ? (
                                <span className="flex items-center justify-center">
                                    <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                        <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                                        <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                    </svg>
                                    Translating...
                                </span>
                            ) : (
                                'Translate Text'
                            )}
                        </button>
                    </div>

                    {error && (
                        <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg relative mb-6 font-poppins" role="alert">
                            <strong className="font-bold">Error!</strong>
                            <span className="block sm:inline ml-2">{error}</span>
                        </div>
                    )}

                    {translatedText && (
                        <div className="bg-gray-50 p-4 sm:p-6 rounded-lg border border-gray-200">
                            <div className="flex justify-between items-center mb-4">
                                <h2 className="text-xl sm:text-2xl font-bold text-gray-800 font-poppins">
                                    Translated Text:
                                </h2>
                            </div>
                            <div className="whitespace-pre-wrap text-gray-800 leading-relaxed font-poppins">
                                {translatedText}
                            </div>
                        </div>
                    )}

                    <div className="mt-8 pt-6 border-t border-gray-200">
                        <h3 className="text-xl font-bold text-gray-800 mb-4 font-poppins flex justify-between items-center">
                            Recent Translations
                            <button
                                onClick={() => setHistory([])}
                                className="text-sm text-red-600 hover:text-red-800 font-semibold"
                            >
                                Clear History
                            </button>
                        </h3>
                        {history.length > 0 ? (
                            <div className="space-y-4">
                                {history.map((entry, index) => (
                                    <div key={index} className="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
                                        <p className="text-sm text-gray-500 font-medium mb-2 font-poppins">
                                            <span className="font-semibold">Source:</span> {entry.sourceLang} | <span className="font-semibold">Target:</span> {entry.targetLang}
                                        </p>
                                        <p className="text-gray-700 mb-1 font-poppins">
                                            <span className="font-semibold">Input:</span> {entry.input.substring(0, 100)}{entry.input.length > 100 ? '...' : ''}
                                        </p>
                                        <p className="text-gray-800 font-poppins">
                                            <span className="font-semibold">Output:</span> {entry.output.substring(0, 100)}{entry.output.length > 100 ? '...' : ''}
                                        </p>
                                    </div>
                                ))}
                            </div>
                        ) : (
                            <p className="text-gray-500 text-center italic font-poppins">No recent translations.</p>
                        )}
                    </div>
                </div>
            );
        };

        const ToneAdjuster = () => {
            const [inputText, setInputText] = React.useState('');
            const [adjustedText, setAdjustedText] = React.useState('');
            const [toneLevel, setToneLevel] = React.useState(5);
            const [isLoading, setIsLoading] = React.useState(false);
            const [error, setError] = React.useState('');
            const [history, setHistory] = React.useState(() => {
                const savedHistory = localStorage.getItem('lingoMorpherToneHistory');
                return savedHistory ? JSON.parse(savedHistory) : [];
            });

            React.useEffect(() => {
                localStorage.setItem('lingoMorpherToneHistory', JSON.stringify(history));
            }, [history]);

            const handleAdjustTone = async () => {
                setIsLoading(true);
                setError('');
                setAdjustedText('');

                if (!inputText.trim()) {
                    setError('Please enter text to adjust its tone.');
                    setIsLoading(false);
                    return;
                }

                let toneDescription = '';
                if (toneLevel >= 0 && toneLevel <= 2) {
                    toneDescription = 'a very casual and informal tone';
                } else if (toneLevel >= 3 && toneLevel <= 4) {
                    toneDescription = 'a casual tone';
                } else if (toneLevel === 5) {
                    toneDescription = 'a neutral tone';
                } else if (toneLevel >= 6 && toneLevel <= 7) {
                    toneDescription = 'a formal tone';
                } else if (toneLevel >= 8 && toneLevel <= 10) {
                    toneDescription = 'a very formal tone';
                }

                const prompt = `Rewrite the following text in ${toneDescription}, maintaining its original meaning:\n\n${inputText}`;
                let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];

                const payload = { contents: chatHistory };
                const apiKey = "AIzaSyA3uewnpVjG2dxwCgCNEyNBGeqk8cJP0ho";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                let retries = 0;
                const maxRetries = 5;
                const baseDelay = 1000;

                while (retries < maxRetries) {
                    try {
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }

                        const result = await response.json();

                        if (result.candidates && result.candidates.length > 0 &&
                            result.candidates[0].content && result.candidates[0].content.parts &&
                            result.candidates[0].content.parts.length > 0) {
                            const text = result.candidates[0].content.parts[0].text;
                            if (text && text.trim().length > 0) {
                                setAdjustedText(text);
                                setHistory(prevHistory => [{
                                    input: inputText,
                                    output: text,
                                    tone: toneDescription
                                }, ...prevHistory].slice(0, 4));
                                break;
                            } else {
                                setError('Tone adjustment resulted in empty text. Please try a different input.');
                                break;
                            }
                        } else {
                            setError('Failed to get a valid response from the model for tone adjustment. Response structure unexpected.');
                            break;
                        }
                    } catch (e) {
                        retries++;
                        if (retries < maxRetries) {
                            const delay = baseDelay * Math.pow(2, retries - 1);
                            await new Promise(res => setTimeout(res, delay));
                        } else {
                            setError(`Error adjusting tone after multiple retries: ${e.message}.`);
                        }
                    }
                }
                setIsLoading(false);
            };

            return (
                <div className="p-6 sm:p-8 rounded-xl shadow-lg w-full max-w-4xl border border-gray-200 bg-white">
                    <h2 className="text-3xl sm:text-4xl font-extrabold text-center text-gray-800 mb-6 font-poppins">
                        Tone Adjuster
                    </h2>
                    <p className="text-center text-gray-600 mb-8 font-poppins">
                        Adjust the formality or casualness of your text using the slider below!
                    </p>

                    <div className="mb-6">
                        <label htmlFor="toneInputText" className="block text-lg font-medium text-gray-700 mb-2 font-poppins">
                            Your Text:
                        </label>
                        <textarea
                            id="toneInputText"
                            className="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-200 ease-in-out resize-y min-h-[120px] font-poppins"
                            placeholder="Type or paste your text here..."
                            value={inputText}
                            onChange={(e) => setInputText(e.target.value)}
                            rows="6"
                        ></textarea>
                    </div>

                    <div className="mb-8">
                        <label htmlFor="toneLevel" className="block text-lg font-medium text-gray-700 mb-4 font-poppins">
                            Tone Level: <span className="font-bold text-blue-600">{toneLevel}</span>
                        </label>
                        <input
                            type="range"
                            id="toneLevel"
                            min="0"
                            max="10"
                            value={toneLevel}
                            onChange={(e) => setToneLevel(parseInt(e.target.value))}
                            className="w-full"
                        />
                        <div className="flex justify-between text-sm text-gray-600 mt-2 font-poppins">
                            <span>Very Casual (0)</span>
                            <span>Neutral (5)</span>
                            <span>Very Formal (10)</span>
                        </div>
                    </div>

                    <div className="text-center mb-8">
                        <button
                            onClick={handleAdjustTone}
                            className="w-full sm:w-auto px-6 py-3 bg-purple-600 text-white font-semibold rounded-lg shadow-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition duration-300 ease-in-out transform hover:scale-105 font-poppins"
                            disabled={isLoading || !inputText.trim()}
                        >
                            {isLoading ? (
                                <span className="flex items-center justify-center">
                                    <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                        <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                                        <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                    </svg>
                                    Adjusting Tone...
                                </span>
                            ) : (
                                'Adjust Tone'
                            )}
                        </button>
                    </div>

                    {error && (
                        <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg relative mb-6 font-poppins" role="alert">
                            <strong className="font-bold">Error!</strong>
                            <span className="block sm:inline ml-2">{error}</span>
                        </div>
                    )}

                    {adjustedText && (
                        <div className="bg-gray-50 p-4 sm:p-6 rounded-lg border border-gray-200">
                            <div className="flex justify-between items-center mb-4">
                                <h2 className="text-xl sm:text-2xl font-bold text-gray-800 font-poppins">
                                    Adjusted Text:
                                </h2>
                            </div>
                            <div className="whitespace-pre-wrap text-gray-800 leading-relaxed font-poppins">
                                {adjustedText}
                            </div>
                        </div>
                    )}

                    <div className="mt-8 pt-6 border-t border-gray-200">
                        <h3 className="text-xl font-bold text-gray-800 mb-4 font-poppins flex justify-between items-center">
                            Recent Tone Adjustments
                            <button
                                onClick={() => setHistory([])}
                                className="text-sm text-red-600 hover:text-red-800 font-semibold"
                            >
                                Clear History
                            </button>
                        </h3>
                        {history.length > 0 ? (
                            <div className="space-y-4">
                                {history.map((entry, index) => (
                                    <div key={index} className="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
                                        <p className="text-sm text-gray-500 font-medium mb-2 font-poppins">
                                            <span className="font-semibold">Tone:</span> {entry.tone}
                                        </p>
                                        <p className="text-gray-700 mb-1 font-poppins">
                                            <span className="font-semibold">Input:</span> {entry.input.substring(0, 100)}{entry.input.length > 100 ? '...' : ''}
                                        </p>
                                        <p className="text-gray-800 font-poppins">
                                            <span className="font-semibold">Output:</span> {entry.output.substring(0, 100)}{entry.output.length > 100 ? '...' : ''}
                                        </p>
                                    </div>
                                ))}
                            </div>
                        ) : (
                            <p className="text-gray-500 text-center italic font-poppins">No recent tone adjustments.</p>
                        )}
                    </div>
                </div>
            );
        };

        const SlangDecoder = () => {
            const [inputText, setInputText] = React.useState('');
            const [decodedText, setDecodedText] = React.useState('');
            const [isLoading, setIsLoading] = React.useState(false);
            const [error, setError] = React.useState('');
            const [inputSlangLang, setInputSlangLang] = React.useState('en');
            const [history, setHistory] = React.useState(() => {
                const savedHistory = localStorage.getItem('lingoMorpherSlangHistory');
                return savedHistory ? JSON.parse(savedHistory) : [];
            });

            React.useEffect(() => {
                localStorage.setItem('lingoMorpherSlangHistory', JSON.stringify(history));
            }, [history]);

            const handleDecodeSlang = async () => {
                setIsLoading(true);
                setError('');
                setDecodedText('');

                if (!inputText.trim()) {
                    setError('Please enter text containing slang to decode.');
                    setIsLoading(false);
                    return;
                }

                const langMap = {
                    'en': 'English',
                    'ta': 'Tamil',
                    'hi': 'Hindi'
                };
                const prompt = `Explain the slang or translate the following text from ${langMap[inputSlangLang]} into standard, easy-to-understand English:\n\n${inputText}`;
                let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];

                const payload = { contents: chatHistory };
                const apiKey = "AIzaSyA3uewnpVjG2dxwCgCNEyNBGeqk8cJP0ho";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                let retries = 0;
                const maxRetries = 5;
                const baseDelay = 1000;

                while (retries < maxRetries) {
                    try {
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }

                        const result = await response.json();

                        if (result.candidates && result.candidates.length > 0 &&
                            result.candidates[0].content && result.candidates[0].content.parts &&
                            result.candidates[0].content.parts.length > 0) {
                            const text = result.candidates[0].content.parts[0].text;
                            if (text && text.trim().length > 0) {
                                setDecodedText(text);
                                setHistory(prevHistory => [{
                                    input: inputText,
                                    output: text,
                                    inputLang: langMap[inputSlangLang]
                                }, ...prevHistory].slice(0, 4));
                                break;
                            } else {
                                setError('Decoding resulted in empty text. Please try a different input.');
                                break;
                            }
                        } else {
                            setError('Failed to get a valid response from the model for slang decoding. Response structure unexpected.');
                            break;
                        }
                    } catch (e) {
                        retries++;
                        if (retries < maxRetries) {
                            const delay = baseDelay * Math.pow(2, retries - 1);
                            await new Promise(res => setTimeout(res, delay));
                        } else {
                            setError(`Error decoding slang after multiple retries: ${e.message}.`);
                        }
                    }
                }
                setIsLoading(false);
            };

            return (
                <div className="p-6 sm:p-8 rounded-xl shadow-lg w-full max-w-4xl border border-gray-200 bg-white">
                    <h2 className="text-3xl sm:text-4xl font-extrabold text-center text-gray-800 mb-6 font-poppins">
                        Slang Decoder
                    </h2>
                    <p className="text-center text-gray-600 mb-8 font-poppins">
                        Enter slang or phrases to get their meaning in standard English!
                    </p>

                    <div className="mb-6">
                        <label htmlFor="inputSlangLang" className="block text-lg font-medium text-gray-700 mb-2 font-poppins">
                            Input Slang Language:
                        </label>
                        <select
                            id="inputSlangLang"
                            className="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-200 ease-in-out bg-white font-poppins"
                            value={inputSlangLang}
                            onChange={(e) => setInputSlangLang(e.target.value)}
                        >
                            <option value="en">English</option>
                            <option value="ta">Tamil</option>
                            <option value="hi">Hindi</option>
                        </select>
                    </div>

                    <div className="mb-6">
                        <label htmlFor="slangInputText" className="block text-lg font-medium text-gray-700 mb-2 font-poppins">
                            Slang Text:
                        </label>
                        <textarea
                            id="slangInputText"
                            className="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-200 ease-in-out resize-y min-h-[120px] font-poppins"
                            placeholder="e.g., 'rizz', 'cap no cap', 'it's giving', 'bet' (English slang) or Tamil/Hindi slang"
                            value={inputText}
                            onChange={(e) => setInputText(e.target.value)}
                            rows="6"
                        ></textarea>
                    </div>

                    <div className="text-center mb-8">
                        <button
                            onClick={handleDecodeSlang}
                            className="w-full sm:w-auto px-6 py-3 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition duration-300 ease-in-out transform hover:scale-105 font-poppins"
                            disabled={isLoading || !inputText.trim()}
                        >
                            {isLoading ? (
                                <span className="flex items-center justify-center">
                                    <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                        <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                                        <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                    </svg>
                                    Decoding...
                                </span>
                            ) : (
                                'Decode Slang'
                            )}
                        </button>
                    </div>

                    {error && (
                        <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg relative mb-6 font-poppins" role="alert">
                            <strong className="font-bold">Error!</strong>
                            <span className="block sm:inline ml-2">{error}</span>
                        </div>
                    )}

                    {decodedText && (
                        <div className="bg-gray-50 p-4 sm:p-6 rounded-lg border border-gray-200">
                            <h2 className="text-xl sm:text-2xl font-bold text-gray-800 mb-4 font-poppins">
                                Decoded Text:
                            </h2>
                            <div className="whitespace-pre-wrap text-gray-800 leading-relaxed font-poppins">
                                {decodedText}
                            </div>
                        </div>
                    )}

                    <div className="mt-8 pt-6 border-t border-gray-200">
                        <h3 className="text-xl font-bold text-gray-800 mb-4 font-poppins flex justify-between items-center">
                            Recent Decodings
                            <button
                                onClick={() => setHistory([])}
                                className="text-sm text-red-600 hover:text-red-800 font-semibold"
                            >
                                Clear History
                            </button>
                        </h3>
                        {history.length > 0 ? (
                            <div className="space-y-4">
                                {history.map((entry, index) => (
                                    <div key={index} className="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
                                        <p className="text-sm text-gray-500 font-medium mb-2 font-poppins">
                                            <span className="font-semibold">Input Language:</span> {entry.inputLang || 'English'}
                                        </p>
                                        <p className="text-gray-700 mb-1 font-poppins">
                                            <span className="font-semibold">Input:</span> {entry.input.substring(0, 100)}{entry.input.length > 100 ? '...' : ''}
                                        </p>
                                        <p className="text-gray-800 font-poppins">
                                            <span className="font-semibold">Output:</span> {entry.output.substring(0, 100)}{entry.output.length > 100 ? '...' : ''}
                                        </p>
                                    </div>
                                ))}
                            </div>
                        ) : (
                            <p className="text-gray-500 text-center italic font-poppins">No recent decodings.</p>
                        )}
                    </div>
                </div>
            );
        };


        const SplashScreen = ({ onAnimationEnd }) => {
            return (
                <div className="fixed inset-0 bg-gray-900 flex items-center justify-center z-50">
                    <h1
                        className="text-6xl sm:text-8xl font-extrabold text-white fade-in-animation great-vibes-font"
                        onAnimationEnd={onAnimationEnd}
                    >
                        Lingo Morpher
                    </h1>
                </div>
            );
        };

        const App = () => {
            const [activeTab, setActiveTab] = React.useState('creative');
            const [showSplash, setShowSplash] = React.useState(true);

            React.useEffect(() => {
                const timer = setTimeout(() => {
                    setShowSplash(false);
                }, 16000); // Changed to 16 seconds
                return () => clearTimeout(timer);
            }, []);

            const [inputText, setInputText] = React.useState('');
            const [outputStyle, setOutputStyle] = React.useState('poem');
            const [outputText, setOutputText] = React.useState('');
            const [isLoadingCreative, setIsLoadingCreative] = React.useState(false);
            const [errorCreative, setErrorCreative] = React.useState('');
            const [creativeHistory, setCreativeHistory] = React.useState(() => {
                const savedHistory = localStorage.getItem('lingoMorpherCreativeHistory');
                return savedHistory ? JSON.parse(savedHistory) : [];
            });

            React.useEffect(() => {
                localStorage.setItem('lingoMorpherCreativeHistory', JSON.stringify(creativeHistory));
            }, [creativeHistory]);

            const handleCreativeTransform = async () => {
                setIsLoadingCreative(true);
                setErrorCreative('');
                setOutputText('');

                if (!inputText.trim()) {
                    setErrorCreative('Please enter text to transform.');
                    setIsLoadingCreative(false);
                    return;
                }

                let prompt = '';
                let isValidInput = true;
                let errorMessage = '';

                if (outputStyle === 'poem') {
                    prompt = `Transform the following text into a poem, without changing its core meaning or adding new scenarios:\n\n${inputText}`;
                } else if (outputStyle === 'song') {
                    prompt = `Transform the following text into song lyrics, without changing its core meaning or adding new scenarios. Focus on rhythm and rhyme suitable for a song:\n\n${inputText}`;
                } else if (outputStyle === 'quote') {
                    prompt = `Condense the following text into a concise, impactful quote (1-2 sentences), preserving its core meaning:\n\n${inputText}`;
                } else if (outputStyle === 'essay') {
                    prompt = `Expand the following text into a short essay, elaborating on its core meaning without introducing new scenarios. Aim for a coherent and well-structured piece:\n\n${inputText}`;
                } else if (outputStyle === 'shakespearean') {
                    prompt = `Rewrite the following text in the style of William Shakespeare, using archaic language, poetic phrasing, and dramatic flair, but without changing its core meaning or adding new scenarios:\n\n${inputText}`;
                } else if (outputStyle === 'summary') {
                    prompt = `Provide a concise summary of the following text, capturing its main points and core meaning:\n\n${inputText}`;
                }
                else {
                    isValidInput = false;
                    errorMessage = 'Please select a valid output style.';
                }

                if (!isValidInput) {
                    setErrorCreative(errorMessage);
                    setIsLoadingCreative(false);
                    return;
                }

                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });

                const payload = { contents: chatHistory };
                const apiKey = "AIzaSyA3uewnpVjG2dxwCgCNEyNBGeqk8cJP0ho";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                let retries = 0;
                const maxRetries = 5;
                const baseDelay = 1000;

                while (retries < maxRetries) {
                    try {
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }

                        const result = await response.json();

                        if (result.candidates && result.candidates.length > 0 &&
                            result.candidates[0].content && result.candidates[0].content.parts &&
                            result.candidates[0].content.parts.length > 0) {
                            const text = result.candidates[0].content.parts[0].text;
                            setOutputText(text);
                            setCreativeHistory(prevHistory => [{
                                input: inputText,
                                output: text,
                                style: outputStyle
                            }, ...prevHistory].slice(0, 4));
                            break;
                        } else {
                            setErrorCreative('Failed to get a valid response from the model. Please try again.');
                            break;
                        }
                    } catch (e) {
                        retries++;
                        if (retries < maxRetries) {
                            const delay = baseDelay * Math.pow(2, retries - 1);
                            await new Promise(res => setTimeout(res, delay));
                        } else {
                            setErrorCreative(`Error transforming text: ${e.message}. Please try again later.`);
                        }
                    }
                }
                setIsLoadingCreative(false);
            };


            return (
                <div className="min-h-screen bg-gray-100 flex flex-col sm:flex-row">
                    {showSplash && <SplashScreen onAnimationEnd={() => setShowSplash(false)} />}

                    <div className="w-full sm:w-64 bg-gray-800 text-white flex flex-col p-4 space-y-4 shadow-lg">
                        <h2 className="text-2xl font-bold mb-4 text-center font-poppins italic">Lingo Morpher</h2>
                        <button
                            onClick={() => setActiveTab('creative')}
                            className={`w-full text-left px-4 py-2 rounded-lg transition duration-200 ease-in-out font-poppins ${activeTab === 'creative' ? 'bg-purple-600 hover:bg-purple-700 shadow-md' : 'hover:bg-gray-700'}`}
                        >
                            Creative Translator
                        </button>
                        <button
                            onClick={() => setActiveTab('language')}
                            className={`w-full text-left px-4 py-2 rounded-lg transition duration-200 ease-in-out font-poppins ${activeTab === 'language' ? 'bg-teal-600 hover:bg-teal-700 shadow-md' : 'hover:bg-gray-700'}`}
                        >
                            Language Translator
                        </button>
                        <button
                            onClick={() => setActiveTab('tone')}
                            className={`w-full text-left px-4 py-2 rounded-lg transition duration-200 ease-in-out font-poppins ${activeTab === 'tone' ? 'bg-indigo-600 hover:bg-indigo-700 shadow-md' : 'hover:bg-gray-700'}`}
                        >
                            Tone Adjuster
                        </button>
                        <button
                            onClick={() => setActiveTab('slang')}
                            className={`w-full text-left px-4 py-2 rounded-lg transition duration-200 ease-in-out font-poppins ${activeTab === 'slang' ? 'bg-pink-600 hover:bg-pink-700 shadow-md' : 'hover:bg-gray-700'}`}
                        >
                            Slang Decoder
                        </button>
                    </div>

                    <div className="flex-1 flex items-center justify-center p-4 sm:p-6 lg:p-8">
                        {activeTab === 'creative' ? (
                            <div className="bg-white p-6 sm:p-8 rounded-xl shadow-lg w-full max-w-4xl border border-gray-200">
                                <h1 className="text-3xl sm:text-4xl font-extrabold text-center text-gray-800 mb-6 font-poppins">
                                    Creative Translator
                                </h1>
                                <p className="text-center text-gray-600 mb-8 font-poppins">
                                    Enter your text below and transform it into various creative styles!
                                </p>

                                <div className="mb-6">
                                    <label htmlFor="inputText" className="block text-lg font-medium text-gray-700 mb-2 font-poppins">
                                        Your Text:
                                    </label>
                                    <textarea
                                        id="inputText"
                                        className="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-200 ease-in-out resize-y min-h-[120px] font-poppins"
                                        placeholder="Type or paste any text here..."
                                        value={inputText}
                                        onChange={(e) => setInputText(e.target.value)}
                                        rows="6"
                                    ></textarea>
                                </div>

                                <div className="flex flex-col sm:flex-row items-center justify-between mb-8 space-y-4 sm:space-y-0 sm:space-x-4">
                                    <div className="w-full sm:w-auto">
                                        <label htmlFor="outputStyle" className="block text-lg font-medium text-gray-700 mb-2 font-poppins">
                                            Choose Style:
                                        </label>
                                        <select
                                            id="outputStyle"
                                            className="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-200 ease-in-out bg-white font-poppins"
                                            value={outputStyle}
                                            onChange={(e) => setOutputStyle(e.target.value)}
                                        >
                                            <option value="poem">Poem</option>
                                            <option value="song">Song Lyrics</option>
                                            <option value="quote">Quote</option>
                                            <option value="essay">Essay</option>
                                            <option value="shakespearean">Shakespearean</option>
                                            <option value="summary">Summary</option>
                                        </select>
                                    </div>
                                    <button
                                        onClick={handleCreativeTransform}
                                        className="w-full sm:w-auto px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-300 ease-in-out transform hover:scale-105 font-poppins"
                                        disabled={isLoadingCreative || !inputText.trim()}
                                    >
                                        {isLoadingCreative ? (
                                            <span className="flex items-center justify-center">
                                                <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                                    <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                                                    <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                                </svg>
                                                Transforming...
                                            </span>
                                        ) : (
                                            'Transform Text'
                                        )}
                                    </button>
                                </div>

                                {errorCreative && (
                                    <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg relative mb-6 font-poppins" role="alert">
                                        <strong className="font-bold">Error!</strong>
                                        <span className="block sm:inline ml-2">{errorCreative}</span>
                                    </div>
                                )}

                                {outputText && (
                                    <div className="bg-gray-50 p-4 sm:p-6 rounded-lg border border-gray-200">
                                        <div className="flex justify-between items-center mb-4">
                                            <h2 className="text-xl sm:text-2xl font-bold text-gray-800 font-poppins">
                                                Transformed Text:
                                            </h2>
                                        </div>
                                        <div className="whitespace-pre-wrap text-gray-800 leading-relaxed font-poppins">
                                            {outputText}
                                        </div>
                                    </div>
                                )}

                                <div className="mt-8 pt-6 border-t border-gray-200">
                                    <h3 className="text-xl font-bold text-gray-800 mb-4 font-poppins flex justify-between items-center">
                                        Recent Creative Conversions
                                        <button
                                            onClick={() => setCreativeHistory([])}
                                            className="text-sm text-red-600 hover:text-red-800 font-semibold"
                                        >
                                            Clear History
                                        </button>
                                    </h3>
                                    {creativeHistory.length > 0 ? (
                                        <div className="space-y-4">
                                            {creativeHistory.map((entry, index) => (
                                                <div key={index} className="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
                                                    <p className="text-sm text-gray-500 font-medium mb-2 font-poppins">
                                                        <span className="font-semibold">Style:</span> {entry.style}
                                                    </p>
                                                    <p className="text-gray-700 mb-1 font-poppins">
                                                        <span className="font-semibold">Input:</span> {entry.input.substring(0, 100)}{entry.input.length > 100 ? '...' : ''}
                                                    </p>
                                                    <p className="text-gray-800 font-poppins">
                                                        <span className="font-semibold">Output:</span> {entry.output.substring(0, 100)}{entry.output.length > 100 ? '...' : ''}
                                                    </p>
                                                </div>
                                            ))}
                                        </div>
                                    ) : (
                                        <p className="text-gray-500 text-center italic font-poppins">No recent creative conversions.</p>
                                    )}
                                </div>
                            </div>
                        ) : activeTab === 'language' ? (
                            <LanguageTranslator />
                        ) : activeTab === 'tone' ? (
                            <ToneAdjuster />
                        ) : (
                            <SlangDecoder />
                        )}
                    </div>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
